/* audiochart 0.2.1 - 2017-02-02 - MIT licence */

!function(a){"use strict";var b=!1,c=function(){function a(a){this.data=a}return a.prototype.numSeries=function(){return this.data.getNumberOfColumns()-1},a.prototype.seriesNames=function(){for(var a=[],b=0;b<this.data.getNumberOfColumns()-1;b++)a.push(this.data.getColumnLabel(b));return a},a.prototype.seriesMin=function(a){return this.data.getColumnRange(a+1).min},a.prototype.seriesMax=function(a){return this.data.getColumnRange(a+1).max},a.prototype.seriesValue=function(a,b){return this.data.getValue(b,a+1)},a.prototype.seriesLength=function(a){return this.data.getNumberOfRows()},a}(),d=function(){function a(a){if("string"==typeof a)this.object=JSON.parse(a);else{if("object"!=typeof a)throw Error("Please provide a JSON string or derived object.");this.object=a}}return a.prototype.numSeries=function(){return this.object.data.length},a.prototype.seriesNames=function(){for(var a=[],b=0;b<this.object.data.length;b++)a.push(this.object.data[b].series);return a},a.prototype.seriesMin=function(a){return Math.min.apply(this,this.object.data[a].values)},a.prototype.seriesMax=function(a){return Math.max.apply(this,this.object.data[a].values)},a.prototype.seriesValue=function(a,b){return this.object.data[a].values[b]},a.prototype.seriesLength=function(a){return this.object.data[a].values.length},a}(),e=function(){function a(a){if(this.table=a,!this.table)throw Error("No table given.")}return a.prototype.numSeries=function(){return this.table.getElementsByTagName("tr")[0].children.length},a.prototype.seriesNames=function(){for(var a=this.table.getElementsByTagName("th"),b=[],c=0;c<a.length;c++)b.push(a[c].textContent);return b},a.prototype._seriesFloats=function(a){for(var b=this.table.getElementsByTagName("td"),c=[],d=0;d<b.length;d++)c.push(parseFloat(b[d].textContent));return c},a.prototype.seriesMin=function(a){return Math.min.apply(this,this._seriesFloats(a))},a.prototype.seriesMax=function(a){return Math.max.apply(this,this._seriesFloats(a))},a.prototype.seriesValue=function(a,b){return parseFloat(this.table.getElementsByTagName("tr")[b+1].children[a].textContent)},a.prototype.seriesLength=function(a){return this.table.getElementsByTagName("tr").length-1},a}(),f=function(){function a(a,b){if(this.minimumDatum=a,this.maximumDatum=b,this.minimumDatum>this.maximumDatum)throw Error("minimum datum should be <= maximum datum")}return a.prototype.map=function(a){},a}(),g=function(){function a(a,b,c,d){if(this.minimumFrequency=c,this.maximumFrequency=d,f.call(this,a,b),this.minimumFrequency>this.maximumFrequency)throw Error("minimum frequency should be <= maximum frequency");this.dataRange=this.maximumDatum-this.minimumDatum}return a.prototype=Object.create(f.prototype),a.prototype.constructor=a,a.prototype.map=function(a){var b;return b=this.dataRange?(a-this.minimumDatum)/this.dataRange:.5,this.minimumFrequency+b*(this.maximumFrequency-this.minimumFrequency)},a}(),h=function(){function a(a){this.context=a}return a.prototype.start=function(){this.oscillator=this.context.createOscillator(),this.oscillator.connect(this.context.destination),this.oscillator.start(0)},a.prototype.frequency=function(a){this.oscillator.frequency.value=a},a.prototype.stop=function(){this.oscillator.stop()},a}(),i=function(){function a(a,b,c,d,e){this.data=b,this.pitchMapper=c,this.sounder=d,arguments.length<5?this.visualCallback=null:this.visualCallback=e,this.interval=Math.ceil(a/this.data.seriesLength(0)),this.seriesMaxIndex=this.data.seriesLength(0)-1,this._state="ready"}return a.prototype.playPause=function(){switch(this._state){case"ready":this._play();break;case"playing":this._pause();break;case"paused":this._startPlaying();break;case"finished":this._play();break;default:throw Error("Player error: invalid state: "+String(this._state))}},a.prototype._play=function(){this.startTime=new Date,this.sounder.start(0),this.playIndex=0,this.skippedCalls=0,this._startPlaying()},a.prototype._startPlaying=function(){this._state="playing",this._playCore();var a=this;this.intervalID=setInterval(function(){a._playCore()},this.interval)},a.prototype._playCore=function(){if(b&&this.interval<10&&this.playIndex!==this.seriesMaxIndex&&this.playIndex%2===0)return this.playIndex++,void this.skippedCalls++;if(null!==this.visualCallback&&this.visualCallback(0,this.playIndex),this.sounder.frequency(this.pitchMapper.map(this.data.seriesValue(0,this.playIndex))),this.playIndex===this.seriesMaxIndex){clearInterval(this.intervalID);var a=this;setTimeout(function(){a.sounder.stop()},this.interval),this._state="finished"}this.playIndex+=1},a.prototype._pause=function(){clearInterval(this.intervalID),this._state="paused"},a.prototype.stepBackward=function(a){var b=a||50;this.playIndex-=b,this.playIndex<0&&(this.playIndex=0),"paused"===this._state&&this._playCore()},a.prototype.stepForward=function(a){var b=a||50;this.playIndex+=b,this.playIndex>this.seriesMaxIndex&&(this.playIndex=this.seriesMaxIndex),"paused"===this._state&&this._playCore()},a}(),j=function(){function a(){}var c=null,d=function(){return void 0!==window.AudioContext?new window.AudioContext:void 0!==window.webkitAudioContext?(b=!0,new window.webkitAudioContext):null};return a.get=function(){return null!==c?c:c=d()},a}(),k=function(a){return function(b,c){a.setSelection([{row:c,column:b+1}])}},l=function(a,b){return function(c,d){for(var e,f=a.getElementsByTagName("td"),g=0;g<f.length;g++)e=f[g],e.classList.remove(b);e=a.getElementsByTagName("td")[d],e.classList.add(b)}},m=function(){function a(a,b){if(!a)throw Error("No container given");if(a.setAttribute("tabindex","0"),a.addEventListener("keydown",this.keypressHandler.bind(this)),!b)throw Error("No Player given");this.player=b}function b(a){if(a.key)return a.key;if(a.keyIdentifier)return a.keyIdentifier;throw new Error("Keyboard Events API unsupported")}return a.prototype.keypressHandler=function(a){a.preventDefault(),"Right"===b(a)?this.handleRight():"Left"===b(a)?this.handleLeft():"U+0020"===b(a)&&this.handleSpace()},a.prototype.handleLeft=function(){this.player.stepBackward()},a.prototype.handleRight=function(){this.player.stepForward()},a.prototype.handleSpace=function(){this.player.playPause()},a}(),n=function(){function a(b,c){var d=a._assignWrapperCallback(b),e=new d.Wrapper(d.parameter),f=d.callback,j=new g(e.seriesMin(0),e.seriesMax(0),b.frequencyLow,b.frequencyHigh),k=new h(c);this.player=new i(b.duration,e,j,k,f),b.chartContainer&&new m(b.chartContainer,this.player)}return a.prototype.playPause=function(){this.player.playPause()},a._assignWrapperCallback=function(a){var b={Wrapper:null,parameter:null,callback:null};switch(a.type){case"google":b.Wrapper=c,b.parameter=a.data,a.hasOwnProperty("chart")&&(b.callback=k(a.chart));break;case"json":b.Wrapper=d,b.parameter=a.data;break;case"htmlTable":b.Wrapper=e,b.parameter=a.table,a.hasOwnProperty("highlightClass")&&(b.callback=l(a.table,a.highlightClass));break;default:throw Error("Invalid data type '"+a.type+"' given.")}return b},a}(),o=function(){function a(a,b){var c="Sorry, your browser doesn't support the Web Audio API.";if(arguments.length<2&&(b=j.get(),null===b))throw Error(c);return new n(a,b)}return a}();a.AudioChart=o}(window);
//# sourceMappingURL=audiochart.min.js.map